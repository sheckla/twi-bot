<!doctype html>
<html lang="de">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="style.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
  href="https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
  rel="stylesheet">
<title>Twi-Bot KI-Pipeline Test</title>

<div class="container">
  <h1 style="text-align:center">Twi-Bot Test Client</h1>
  <div class="section">
    <p>Dies ist ein Test-Client für die KI-Pipeline bestehend aus STT, LLM und TTS.</p>
    <p>Die API ist unter "https://one.beezlebug.com/sprachbot"</p>
    <h4> Hinweise zur Nutzung</h4>
    <p>
      1. Audio eingeben: entweder per Push-to-Talk oder Audiodatei<br>
      2. STT: Audio in Text umwandeln<br>
      3. LLM: Frage an LLM stellen<br>
      4. TTS: Antwort des LLM in Audio umwandeln<br>
    </p>
  </div>

  <div class="divider"></div>


  <div class="section">
    <!-- Audioeingabe -->
    <h2>Dashboard</h2>
    <p>(Leertaste zum Starten/Stoppen)</p>
    <table>
      <tr>
      </tr>
      <tr>
        <td>
          <button id="push-to-talk-begin" onclick="recordAudio()">Push-to-talk</button>
        </td>
        <td>
          <input id="file" class="input-file" type="file" accept="audio/*" style="width:100%" />
          <audio id="inputPlayer" controls></audio>
        </td>
      </tr>
    </table>
    <!-- Dashboard -->
    <table>
      <tr>
      </tr>
      <tr>
        <td>
          <button id="pipeline-start" onclick="startPipeline()">→ Pipeline starten</button>
          <button id="clear" class="delete-button" onclick="clearAll()">Alles löschen</button><br>
          <button id="reset" class="delete-button" onclick="clearConversation()">Clear Conversation</button>
          Conversation: <a id="conversation"> none</a><br>
        </td>
        <td>
          <div id="final-success" class="answer">
            <a id="loading"></a><br><br>
            <a id="total-ms-server"></a><br>
            <a id="total-ms-network"></a><br>
            <a id="total-ms-total"></a>
          </div>
        </td>
      </tr>
    </table>
  </div>
  <div class="divider"></div>
  <!-- STT -->
  <div class="section">
    <table>
      <tr>
        <th colspan="2">
          <h2>1. Speech to Text (OpenAI Whisper)</h2>
        </th>
      </tr>
      <tr>
        <td>
          <select id="whisper-model">
            <option value="large-v3-turbo">Large V3 Turbo</option>
            <option value="small">Kleines (schnelleres) Whisper Modell</option>
            <option value="medium">Mittleres Whisper Modell</option>
          </select>
          <button id="stt-button" onclick="startSTT()">→ Transkribieren</button>
        </td>
        <td id="stt-processing">
          <div id="stt-success" class="answer">
            <a id="stt-text">(Sende eine Audio zum Transkribieren ein...)</a><br><br>
            <a id="stt-ms-server"></a><br>
            <a id="stt-ms-network"></a><br>
            <a id="stt-ms-total"></a>
          </div>
        </td>
      </tr>
    </table>

    <!-- LLM -->

    <table>
      <tr>
        <th colspan="2">
          <h2>2. Large Language Model
            <a href="https://agent.cybob.com/console/agents/detail/?identifier=33940100-cb19-41dd-b415-e6e82e9c3bd4">Chatbot</a>
            (Google Gemma3:1b)</h2>
        </th>
      </tr>
      <tr>
        <td>
          <input id="llm-question" placeholder="Frage stellen" />
          <button id="llm-ask" onclick="startLLM()">→ Chatbot fragen</button>
        </td>
        <td id="llm-processing">
          <div id="llm-success" class="answer">
            <a id="llm-text">(Frage den Chatbot für eine Antwort!)</a><br><br>
            <a id="llm-ms-server"></a><br>
            <a id="llm-ms-network"></a><br>
            <a id="llm-ms-total"></a>
          </div>
        </td>
      </tr>

      <!-- TTS -->

      <table>
        <tr>
          <th colspan="2">
            <h2>Text to Speech (Piper)</h2>
          </th>
        </tr>
        <tr>
          <td>
            <input id="tts-text" type="text" placeholder="Text für TTS" /><br>
            <select id="thorsten-emotion">
              <option value="0">Fröhlich</option>
              <option value="1">Wütend</option>
              <option value="2">Verekelt</option>
              <option value="3">Betrunken</option>
              <option value="4">Neutral</option>
              <option value="5">Schläfrig</option>
              <option value="6">Überrascht</option>
              <option value="7">Flüstern</option>
            </select>
            <button id="tts" onclick="startTTS()">→ TTS generieren</button><br>
          </td>
          <td>
            <div id="tts-success" class="answer">
              (Generierte Audio wird hier angezeigt und abgespielt...)
              <audio id="ttsPlayer" controls></audio><br>
              <a id="tts-ms-server"></a><br>
              <a id="tts-ms-network"></a><br>
              <a id="tts-ms-total"></a>
            </div>
          </td>
        </tr>
      </table>
  </div>
</div>

<pre id="log" style="white-space:pre-wrap;font:12px/1.4 monospace;"></pre>
<script src="app.js"></script>

</html>
